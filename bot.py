# -*- coding: utf-8 -*-
import telebot
import random

TOKEN = "—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–æ—Ç_BotFather"

bot = telebot.TeleBot(TOKEN)

# üìú –±–∞–∑–∞ –æ—Ç–≤–µ—Ç–æ–≤
responses = {
    "–ø—Ä–∏–≤–µ—Ç": [
        "–ó–¥–∞—Ä–æ–≤–∞, –Ω—É —á—ë, –æ–ø—è—Ç—å —Ñ–∏–¥–∏—Ç—å –ø—Ä–∏—à—ë–ª? üòè",
        "–û, –ø—Ä–∏–≤–µ—Ç... —É–∂–µ –≤–∏–∂—É, –∫–∞–∫ —Ç—ã —Å–Ω–æ–≤–∞ —Å–∞–ø–ø–æ—Ä—Ç–æ–º –ª–µ–∑–µ—à—å –Ω–∞ –º–∏–¥ ü§¶‚Äç‚ôÇÔ∏è",
    ],
    "–∫–∞–∫ –¥–µ–ª–∞": [
        "–ö–∞–∫ —É –∫—Ä–∏–ø–æ–≤ –Ω–∞ 5-–π –º–∏–Ω—É—Ç–µ ‚Äî –Ω–µ –æ—á–µ–Ω—å, –Ω–æ –∂–∏–≤—É üòí",
        "–õ—É—á—à–µ, —á–µ–º —É —Ç–µ–±—è –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ç–∫–∏ üòÇ",
    ],
    "–¥–æ—Ç–∞": [
        "–î–æ—Ç–∞ ‚Äî —ç—Ç–æ –Ω–µ –∏–≥—Ä–∞, —ç—Ç–æ –¥–∏–∞–≥–Ω–æ–∑, –±—Ä–∞—Ç–∏—à–∫–∞ üíÄ",
        "–ï—Å–ª–∏ —Ç—ã –µ—â—ë –Ω–µ tilted ‚Äî –∑–Ω–∞—á–∏—Ç, –Ω–µ –∏–≥—Ä–∞–ª —Å–µ–≥–æ–¥–Ω—è.",
    ],
    "–ø–æ–∫–∞": [
        "–ù—É –≤—Å—ë, –ª–∏–≤–∞–π —Å –ø–æ–∑–æ—Ä–æ–º ü§£",
        "–°—á–∞—Å—Ç–ª–∏–≤–æ, –Ω–æ —Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–∞—Ñ–∏–¥–∏—à—å üòé",
    ]
}

# üß† –æ—Ç–≤–µ—Ç –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
@bot.message_handler(func=lambda message: True)
def handle_message(message):
    text = message.text.lower()

    for key in responses:
        if key in text:
            reply = random.choice(responses[key])
            bot.reply_to(message, reply)
            break
    else:
        bot.reply_to(message, "–ß—ë —Ç—ã –Ω–µ—Å—ë—à—å –≤–æ–æ–±—â–µ? ü§®")

from flask import Flask, request

app = Flask(__name__)

@app.route("/" + TELEGRAM_TOKEN, methods=["POST"])
def webhook():
    json_update = request.stream.read().decode("utf-8")
    update = telebot.types.Update.de_json(json_update)
    bot.process_new_updates([update])
    return "!", 200

@app.route("/")
def index():
    return "–§–∏–¥–æ—Å –æ–Ω–ª–∞–π–Ω üß†", 200

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–µ–±—Ö—É–∫ (Render –¥–∞—ë—Ç HTTPS)
bot.remove_webhook()
bot.set_webhook(url=f"https://{os.getenv('RENDER_EXTERNAL_HOSTNAME')}/{TELEGRAM_TOKEN}")

print("‚úÖ –§–∏–¥–æ—Å —Å–ª—É—à–∞–µ—Ç —á–µ—Ä–µ–∑ webhook Render...")
app.run(host="0.0.0.0", port=10000)

